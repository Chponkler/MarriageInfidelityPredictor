# Система предсказания измены

## Описание

Эта система использует машинное обучение для предсказания вероятности измены на основе ряда признаков, таких как возраст, образование, религиозность, профессия и другие. Модель обучается с использованием алгоритма **LightGBM** и позволяет пользователю ввести свои данные через анкету. На основе введённых данных система выдает предсказание вероятности измены и визуализирует важную информацию с помощью графиков.

## Зависимости

Для работы системы необходимо установить следующие библиотеки:

```bash
pip install pandas scikit-learn lightgbm matplotlib
```

# Рабочий процесс

## Загрузка и подготовка данных
Используется датасет, содержащий информацию о людях, их браках и изменах. В качестве целевой переменной используется факт наличия измены.

## Предсказание с использованием модели LightGBM
Алгоритм **LightGBM** используется для классификации. После обучения модель предсказывает вероятность измены на основе введённых данных.

## Подбор гиперпараметров
Модель использует оптимальные гиперпараметры, которые были найдены с помощью подбора по сетке (**GridSearchCV**). Эти параметры используются для обучения модели.

## Визуализация результатов
После получения предсказания для пользователя, система генерирует графики, которые показывают важную информацию о распределении вероятности измены в выборке и о том, где находится предсказанная вероятность для конкретного пользователя.

# Анкета для пользователя

Пользователю будет предложено ответить на следующие вопросы:

1. **Возраст вашей жены (в годах)**
2. **Сколько лет вы в браке?** (например, 3.5)
3. **Сколько у вас детей?** (0, 1, 2...)
4. **Уровень религиозности вашей жены:**
   - 1 — Не религиозна
   - 2 — Немного религиозна
   - 3 — Религиозна
   - 4 — Очень религиозна
5. **Уровень образования вашей жены (в годах обучения):**
   - 12 — Среднее образование
   - 14 — Бакалавриат
   - 16 — Магистратура
   - 18+ — Аспирантура
6. **Сфера деятельности вашей жены:**
   - 1 — Студентка
   - 2 — Рабочая (синий воротничок)
   - 3 — Служащая / офисная работа
   - 4 — Техническая профессия
   - 5 — Менеджер / руководитель
   - 6 — Профессионал (врач, юрист и т.д.)
7. **Ваша собственная сфера деятельности:**
   - 1 — Студент
   - 2 — Рабочий
   - 3 — Служащий / офис
   - 4 — Технарь
   - 5 — Менеджер
   - 6 — Профессия высокого уровня

После того как пользователь введет все данные, модель вычислит вероятность измены.

# Методы

## 1. Подготовка данных
Данные загружаются и очищаются от ненужных столбцов. Также создаются новые признаки, такие как **is_high_education** (высшее образование) и **is_high_religious** (высокий уровень религиозности).

## 2. Обучение модели
Для обучения используется **LightGBM**, который является быстрым и эффективным алгоритмом для задачи бинарной классификации. Подбор гиперпараметров осуществляется с помощью **GridSearchCV**, что позволяет найти оптимальные параметры для модели.

## 3. Прогнозирование
После обучения модели, пользователь вводит свои данные через анкету, и система предсказывает вероятность измены на основе введённых значений.

## 4. Визуализация
После предсказания, на основе вероятности, система генерирует два графика:
- **Гистограмма вероятностей измены**: показывает распределение вероятностей для всех пользователей и как предсказания пользователя соотносятся с общим распределением.
- **График важности признаков**: демонстрирует, какие признаки модели наиболее важны для предсказания (например, возраст, количество детей, религиозность и т.д.).

# Графики

## 1. Гистограмма вероятностей измены
Этот график показывает распределение предсказанных вероятностей измены для всех данных. Он позволяет понять, где находится вероятность предсказания для конкретного пользователя.

- **Ось X**: вероятность измены.
- **Ось Y**: количество пользователей с определённой вероятностью измены.
- **Красная линия**: вероятность измены для конкретного пользователя.

## 2. График важности признаков
Этот график показывает, какие признаки имеют наибольшее влияние на предсказания модели. Важность признаков вычисляется с помощью встроенной функции **feature_importances_** модели **LightGBM**.

- **Ось X**: важность признака (влияние на предсказание).
- **Ось Y**: названия признаков.

# Пример использования

После того как все данные введены, система выведет результат анализа, который будет содержать:

- **Вероятность измены** для пользователя.
- **График распределения вероятности**.
- **График важности признаков**.

![image](https://github.com/user-attachments/assets/b6558812-4e5b-4346-bd61-8b81faaa858c)
![image](https://github.com/user-attachments/assets/bacd3192-b0ff-4919-ac59-ca3549813742)

